import { useTranslation } from 'react-i18next';
import { useNavigate, useSearchParams } from 'react-router';

import ActionsCell from '../../components/Common/ActionsCell';
import { snColumn } from '../../components/Common/TableContainer/snColumnDef';

export const use{{capitalizedPageName}}Columns = (onDelete, hasPermission) => {
  const navigate = useNavigate();
  const { t } = useTranslation();
  const [searchParams] = useSearchParams();
  const searchString = searchParams.toString();
  const queryString = searchString ? `?${searchString}` : '';

  const columns = [
    snColumn,
    {{#each columns}}
    {
      accessorKey: '{{this.name}}',
      header: t('{{this.label}}'),
      cell: (info) => info.getValue(),
      {{#if (eq this.type 'Number')}}
      meta: {
        filterVariant: 'range',
      },
      {{/if}}
    },
    {{/each}}
    {
      header: t('actions'),
      id: 'actions',
      size: 100,
      cell: (info) => {
        const id = info.row.original.{{@root.primaryKey}};
        return (
          <ActionsCell
            id={id}
            onView={() => navigate(`/{{@root.pageName}}s/${id}${queryString}`)}
            onEdit={hasPermission('accounts.change_{{@root.pageName}}') 
              ? () => navigate(`/{{@root.pageName}}s/${id}/edit${queryString}`)
              : undefined
            }
            onDelete={hasPermission('accounts.delete_{{@root.pageName}}')
              ? () => onDelete(info.row.original)
              : undefined
            }
          />
        );
      },
    },
  ];

  return columns;
};